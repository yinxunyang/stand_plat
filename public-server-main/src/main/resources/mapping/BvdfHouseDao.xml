<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bestvike.dataCenter.dao.BvdfHouseDao">
	<select id="queryBvdfCorpInfo" resultType="com.bestvike.dataCenter.param.BvdfCorpParam">
		SELECT t.corpid, t.corpName, t.licenseNo, t.certificateNo, t.versionnumber FROM datasource_xjws.REV_CORP_INFO t
		<where>
			<if test="null != param.state and '' != param.state">
				t.state = #{param.state,jdbcType=VARCHAR}
			</if>
			<if test="null != param.appcode and '' != param.appcode">
				AND t.appcode = #{param.appcode,jdbcType=VARCHAR}
			</if>
			<if test="null != param.scopeBeginTime and '' != param.scopeBeginTime">
				<![CDATA[
				AND to_date(t.modifydate,'yyyy-mm-dd hh24:mi:ss') >= to_date(#{param.scopeBeginTime},'yyyy-mm-dd hh24:mi:ss')
                ]]>
			</if>
			<if test="null != param.scopeEndTime and '' != param.scopeEndTime">
				<![CDATA[
				AND to_date(t.modifydate,'yyyy-mm-dd hh24:mi:ss') < to_date(#{param.scopeEndTime},'yyyy-mm-dd hh24:mi:ss')
                ]]>
			</if>
		</where>
	</select>
	<select id="queryBvdfHouseInfo" resultType="com.bestvike.dataCenter.param.BvdfHouseParam">
			select * from (select  t1.sysguid,
		        t1.buycertnos,
		        t1.corpno,
                t1.projectno,
                t1.bldno,
                t1.cellno,
                t1.floorname,
                t1.roomno,
                t1.buynames,
                t1.address,
                t1.housetype
		from arc_houseinfo t1
		minus
		select  t2.sysguid,
		        t2.buycertnos,
		        t2.corpno,
                t2.projectno,
                t2.bldno,
                t2.cellno,
                t2.floorname,
                t2.roomno,
                t2.buynames,
                t2.address,
                t2.housetype
		from mid_aks.copy_houseinfo t2
		)
		<![CDATA[
		where rownum <= #{houseMaxNum}
		]]>
	</select>
	<select id="selectCorpNameByCorpNo" resultType="com.bestvike.dataCenter.param.BvdfCorpParam">
		select corpName, licenseNo from arc_corpinfo where corpNo = #{corpNo,jdbcType=VARCHAR}
	</select>
	<select id="selectBldNameByBldNo" resultType="java.lang.String">
		select bldName from arc_buildinfo where bldNo = #{bldNo,jdbcType=VARCHAR}
	</select>
	<select id="selectCellNameByCellNo" resultType="java.lang.String">
		select cellName from arc_cellinfo where bldNo = #{bldNo,jdbcType=VARCHAR} and cellNo = #{cellNo,jdbcType=VARCHAR} and housetype = #{housetype,jdbcType=VARCHAR}
	</select>
</mapper>