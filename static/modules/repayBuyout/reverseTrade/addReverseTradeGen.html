<div data-container="addReverseTradeGen">
    <component is="bv-form" :key="tags.tableId" v-bind="config"></component>
</div>
<script type="text/javascript">
    require(['jquery', 'util', 'Const'], function ($, util, Const) {
        var vm = util.bind({
            container: 'addReverseTradeGen',
            data: {
                tags: {
                    formId: 'addReverseTradeGenTable'
                },
                config: {
                    title: '冲正',
                    layoutCols: 1,
                    columns: [
                        {
                            name: 'repaySeq',
                            head: '交易流水号',
                            config: {
                                attr: {
                                    maxlength: 32
                                },
                                validate: {
                                    required: true
                                }
                            }
                        },
                        {
                            name: 'repayType',
                            head: '还款类型',
                            edit: {
                                type: 'select'
                            },
                            config: {
                                preset: 'enums',
                                choose: Const.enums.repayEnum,
                                validate: {
                                    required: true
                                }
                            }
                        }
                    ],
                    operates: [
                        {
                            text: '内部冲正',
                            clazz: 'btn-primary',
                            icon: 'icon-save',
                            loading: '处理中...',
                            click: function (event, name, entity, selected, indexes) {
                                util.post({
                                    url: '/api/plr/reverseTradeGen/reverseSave',
                                    data: {
                                        repaySeq: entity.repaySeq,
                                        repayType: entity.repayType,
                                        recordType: 'IN_REVERSE'
                                    },
                                    refresh: true,
                                    async: true
                                })
                                util.modal('hide')
                            }
                        },
                        {
                            text: '外部冲正',
                            clazz: 'btn-primary',
                            icon: 'icon-save',
                            loading: '处理中...',
                            click: function (event, name, entity, selected, indexes) {
                                util.post({
                                    url: '/api/plr/reverseTradeGen/reverseSave',
                                    data: {
                                        repaySeq: entity.repaySeq,
                                        repayType: entity.repayType,
                                        recordType: 'OUT_REVERSE'
                                    },
                                })
                                util.modal('hide')
                            }
                        }
                    ]
                }
            }
        });
    });
</script>
